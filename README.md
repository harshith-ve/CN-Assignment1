# Assignment 1 - Custom DNS Server and Client
## Harshith Venigalla 22110283, Nakka Naga Bhuvith 22110163
## Overview
This project implements a custom DNS server and client in Python. The server resolves domain names to IP addresses based on custom rules defined by the time of day. The client sends domain queries to the server and receives the resolved IP addresses. The project also includes sample packet capture files and reports.


## File Descriptions and Code Overview

- **server.py**: Implements a custom DNS-like server using Python sockets.
   - **Logic:**
      - Listens on all interfaces at port 53535 for TCP connections.
      - Maintains a pool of 15 IP addresses and uses time-based rules to determine which IP to assign for a given query.
      - The rules are:
         - **Morning (04:00-11:59):** Assigns from the first 5 IPs.
         - **Afternoon (12:00-19:59):** Assigns from the middle 5 IPs.
         - **Night (20:00-03:59):** Assigns from the last 5 IPs.
      - For each incoming query (formatted as `header|domain`), the server:
         - Extracts the hour and a sequence ID from the header.
         - Determines the time slot and selects the appropriate IP pool.
         - Responds with the resolved IP address to the client.
      - Handles multiple client connections sequentially.

- **client.py**: Implements a client that extracts DNS queries from a PCAP file and queries the custom server.
   - **Logic:**
      - Reads a provided PCAP file and extracts DNS query domains using Scapy.
      - For each query, generates a custom header (current time + sequence ID).
      - Connects to the server at the specified IP and port.
      - Sends each query in the format `header|domain` and receives the resolved IP.
      - Logs all queries and responses to `report.csv` and prints them to the console.
      - Usage: `python client.py <pcap_file>`

- **rules.json**: Contains the time-based routing rules for IP address assignment, matching the logic in `server.py`.
- **report.csv**: CSV file generated by the client, logging each query's header, domain, and resolved IP address.
- **6.pcap**: Packet capture file in PCAP format, likely containing network traffic for analysis.
- **A1_Linux_pcap.pcapng**: Packet capture file in PCAPNG format, for use with Wireshark or similar tools.


## How to Run the Code

### Prerequisites
- Python 3.x installed on your system.
- Install Scapy for packet parsing (required by `client.py`). You can install it using:
  ```bash
  pip install scapy
  ```

### Running the Server
1. Open a terminal and navigate to the project directory.
2. Run the server script:
   ```bash
   python3 server.py
   ```
   The server will start listening on `0.0.0.0:53535`.

### Running the Client
1. Open another terminal and navigate to the project directory.
2. Run the client script with a PCAP file as input:
   ```bash
   python3 client.py <pcap_file>
   ```
   Replace `<pcap_file>` with the name of your PCAP file (e.g., `6.pcap`).

### Notes
- Ensure the server is running before starting the client.
- The server uses time-based rules (see `rules.json`) to resolve domains to different IP addresses depending on the current time.
- The client will generate a `report.csv` file logging all queries and their resolved IPs.
- You can analyze the provided `.pcap` and `.pcapng` files using Wireshark for network traffic inspection.

## Contact
For any questions or issues, please contact the project maintainer.
